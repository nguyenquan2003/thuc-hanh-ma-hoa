TRUNCATE TABLE MONHOC;
TRUNCATE TABLE GIAOVIEN;
TRUNCATE TABLE LOPHOC;
TRUNCATE TABLE HOCVIEN;
TRUNCATE TABLE GIAOVIEN_DAY_MONHOC;
TRUNCATE TABLE PHANCONG;
TRUNCATE TABLE KETQUA;

DROP TABLE MONHOC CASCADE CONSTRAINTS;
DROP TABLE GIAOVIEN CASCADE CONSTRAINTS;
DROP TABLE LOPHOC CASCADE CONSTRAINTS;
DROP TABLE HOCVIEN CASCADE CONSTRAINTS;
DROP TABLE GIAOVIEN_DAY_MONHOC CASCADE CONSTRAINTS;
DROP TABLE PHANCONG CASCADE CONSTRAINTS;
DROP TABLE KETQUA CASCADE CONSTRAINTS;

CREATE TABLE MONHOC (
    MAMONHOC VARCHAR2(7 BYTE) PRIMARY KEY,
    TENMONHOC NVARCHAR2(50),
    SOCHI NUMBER(*, 0)
);

CREATE TABLE GIAOVIEN (
    MAGV VARCHAR2(7 BYTE) PRIMARY KEY,
    TENGV NVARCHAR2(50),
    NGAYSINH DATE,
    GIOITINH NVARCHAR2(10),
    DIENTHOAI VARCHAR2(11 BYTE),
    MAGVQUANLI VARCHAR2(7 BYTE)
);

ALTER TABLE GIAOVIEN 
ADD CONSTRAINT FK_GV_GVQUANLI FOREIGN KEY (MAGVQUANLI) REFERENCES GIAOVIEN (MAGV);

CREATE TABLE HOCVIEN (
    MAHOCVIEN VARCHAR2(8 BYTE) PRIMARY KEY,
    TENHOCVIEN NVARCHAR2(50),
    NGAYSINH DATE,
    TINHTRANG NVARCHAR2(50),
    MALOP VARCHAR2(8 BYTE)
);

CREATE TABLE LOPHOC (
    MALOP VARCHAR2(8 BYTE) PRIMARY KEY,
    SISO NUMBER(*, 0),
    LOPTRUONG VARCHAR2(8 BYTE),
    GVQUANLI VARCHAR2(7 BYTE),
    NAMBATDAU NUMBER(*, 0),
    NAMKETTHUC NUMBER(*, 0),
    CONSTRAINT FK_LH_GVQUANLI FOREIGN KEY (GVQUANLI) REFERENCES GIAOVIEN (MAGV)
);
ALTER TABLE HOCVIEN
ADD CONSTRAINT FK_HV_LH FOREIGN KEY (MALOP) REFERENCES LOPHOC (MALOP);

CREATE TABLE GIAOVIEN_DAY_MONHOC (
    MAGV VARCHAR2(7 BYTE),
    MAMH VARCHAR2(7 BYTE),
    THAMNIEN NUMBER(*, 0),
    SOLOPDADAY NUMBER(*, 0),
    PRIMARY KEY (MAGV, MAMH)
);
ALTER TABLE GIAOVIEN_DAY_MONHOC 
ADD CONSTRAINT FK_GDM_MH FOREIGN KEY (MAMH) REFERENCES MONHOC (MAMONHOC);

CREATE TABLE PHANCONG (
    MAGV VARCHAR2(7 BYTE),
    MAMH VARCHAR2(7 BYTE),
    MALOP VARCHAR2(8 BYTE),
    PRIMARY KEY (MAGV, MAMH, MALOP)
);
ALTER TABLE PHANCONG 
ADD CONSTRAINT FK_PC_MH FOREIGN KEY (MAMH) REFERENCES MONHOC (MAMONHOC);
ALTER TABLE PHANCONG 
ADD CONSTRAINT FK_PC_LH FOREIGN KEY (MALOP) REFERENCES LOPHOC (MALOP);

CREATE TABLE KETQUA (
    MAHV VARCHAR2(8 BYTE),
    MAMONHOC VARCHAR2(7 BYTE),
    LANTHI NUMBER(*, 0),
    DIEM FLOAT(126),
    PRIMARY KEY (MAHV, MAMONHOC, LANTHI),
    CONSTRAINT FK_KQ_HV FOREIGN KEY (MAHV) REFERENCES HOCVIEN (MAHOCVIEN),
    CONSTRAINT FK_KQ_MH FOREIGN KEY (MAMONHOC) REFERENCES MONHOC (MAMONHOC)
);

INSERT INTO MONHOC (MAMONHOC, TENMONHOC, SOCHI) VALUES ('MH00001', 'Cơ sở dữ liệu', 5);
INSERT INTO MONHOC (MAMONHOC, TENMONHOC, SOCHI) VALUES ('MH00002', 'Cấu trúc dữ liệu', 6);
INSERT INTO MONHOC (MAMONHOC, TENMONHOC, SOCHI) VALUES ('MH00003', 'Mạng máy tính', 4);
INSERT INTO MONHOC (MAMONHOC, TENMONHOC, SOCHI) VALUES ('MH00004', 'Toán cao cấp', 6);
INSERT INTO MONHOC (MAMONHOC, TENMONHOC, SOCHI) VALUES ('MH00005', 'Tin học cơ sở', 3);
INSERT INTO MONHOC (MAMONHOC, TENMONHOC, SOCHI) VALUES ('MH00006', 'Công nghệ phần mềm', 4);
INSERT INTO MONHOC (MAMONHOC, TENMONHOC, SOCHI) VALUES ('MH00007', 'Trí tuệ nhân tạo', 4);
INSERT INTO MONHOC (MAMONHOC, TENMONHOC, SOCHI) VALUES ('MH00008', 'Khai thác dữ liệu', 3);
INSERT INTO MONHOC (MAMONHOC, TENMONHOC, SOCHI) VALUES ('MH00009', 'Phân tích thiết kế hệ thống thông tin', 3);
INSERT INTO MONHOC (MAMONHOC, TENMONHOC, SOCHI) VALUES ('MH00010', 'Hệ thống thông tin', 4);

INSERT INTO GIAOVIEN (MAGV, TENGV, NGAYSINH, GIOITINH, DIENTHOAI, MAGVQUANLI) VALUES ('GV00009', 'Trần Thị Kiều', TO_DATE('1984-01-03', 'YYYY-MM-DD'), 'Nữ', '0977318754', NULL);
INSERT INTO GIAOVIEN (MAGV, TENGV, NGAYSINH, GIOITINH, DIENTHOAI, MAGVQUANLI) VALUES ('GV00010', 'Trần Phương Loan', TO_DATE('1982-04-30', 'YYYY-MM-DD'), 'Nữ', '0223416754', NULL);
INSERT INTO GIAOVIEN (MAGV, TENGV, NGAYSINH, GIOITINH, DIENTHOAI, MAGVQUANLI) VALUES ('GV00008', 'Nguyễn Thị Linh', TO_DATE('1991-07-08', 'YYYY-MM-DD'), 'Nữ', '0988076099', 'GV00009');
INSERT INTO GIAOVIEN (MAGV, TENGV, NGAYSINH, GIOITINH, DIENTHOAI, MAGVQUANLI) VALUES ('GV00005', 'Võ Anh Tuấn', TO_DATE('1986-02-03', 'YYYY-MM-DD'), 'Nam', '0913997979', 'GV00008');
INSERT INTO GIAOVIEN (MAGV, TENGV, NGAYSINH, GIOITINH, DIENTHOAI, MAGVQUANLI) VALUES ('GV00002', 'Nguyễn Thị Như Lan', TO_DATE('1968-01-02', 'YYYY-MM-DD'), 'Nữ', '0974321754', 'GV00005');
INSERT INTO GIAOVIEN (MAGV, TENGV, NGAYSINH, GIOITINH, DIENTHOAI, MAGVQUANLI) VALUES ('GV00001', 'Nguyễn Văn An', TO_DATE('1972-01-02', 'YYYY-MM-DD'), 'Nam', '0977896754', 'GV00002');
INSERT INTO GIAOVIEN (MAGV, TENGV, NGAYSINH, GIOITINH, DIENTHOAI, MAGVQUANLI) VALUES ('GV00003', 'Trần Minh Anh', TO_DATE('1993-03-23', 'YYYY-MM-DD'), 'Nam', '0654396754', 'GV00002');
INSERT INTO GIAOVIEN (MAGV, TENGV, NGAYSINH, GIOITINH, DIENTHOAI, MAGVQUANLI) VALUES ('GV00006', 'Trần Anh Dũng', TO_DATE('1998-04-04', 'YYYY-MM-DD'), 'Nam', '0977893484', 'GV00010');
INSERT INTO GIAOVIEN (MAGV, TENGV, NGAYSINH, GIOITINH, DIENTHOAI, MAGVQUANLI) VALUES ('GV00004', 'Trương Tường Vi', TO_DATE('1979-01-02', 'YYYY-MM-DD'), 'Nữ', '0984578905', 'GV00008');
INSERT INTO GIAOVIEN (MAGV, TENGV, NGAYSINH, GIOITINH, DIENTHOAI, MAGVQUANLI) VALUES ('GV00007', 'Trần Duy Tân', TO_DATE('1972-01-04', 'YYYY-MM-DD'), 'Nam', '0977753254', 'GV00002');

ALTER TABLE LOPHOC DROP CONSTRAINT FK_LH_LOPTRUONG;
INSERT INTO LOPHOC (MALOP, SISO, LOPTRUONG, GVQUANLI, NAMBATDAU, NAMKETTHUC) VALUES ('LH00001', 1, 'HV00002', 'GV00001', 2010, 2014);
INSERT INTO LOPHOC (MALOP, SISO, LOPTRUONG, GVQUANLI, NAMBATDAU, NAMKETTHUC) VALUES ('LH00002', 1, 'HV00003', 'GV00003', 2009, 2013);
INSERT INTO LOPHOC (MALOP, SISO, LOPTRUONG, GVQUANLI, NAMBATDAU, NAMKETTHUC) VALUES ('LH00003', 2, 'HV00004', 'GV00008', 2010, 2014);
INSERT INTO LOPHOC (MALOP, SISO, LOPTRUONG, GVQUANLI, NAMBATDAU, NAMKETTHUC) VALUES ('LH00004', 4, 'HV00008', 'GV00010', 2011, 2015);
INSERT INTO LOPHOC (MALOP, SISO, LOPTRUONG, GVQUANLI, NAMBATDAU, NAMKETTHUC) VALUES ('LH00005', 1, 'HV00009', 'GV00009', 2010, 2014);

INSERT INTO HOCVIEN (MAHOCVIEN, TENHOCVIEN, NGAYSINH, TINHTRANG, MALOP) VALUES ('HV00001', 'Nguyễn Thị Thùy Trang', TO_DATE('1992-02-01', 'YYYY-MM-DD'), 'Buộc thôi học', 'LH00001');
INSERT INTO HOCVIEN (MAHOCVIEN, TENHOCVIEN, NGAYSINH, TINHTRANG, MALOP) VALUES ('HV00002', 'Nguyễn Thị Kim Ngọc', TO_DATE('1993-12-20', 'YYYY-MM-DD'), 'Đang học', 'LH00001');
INSERT INTO HOCVIEN (MAHOCVIEN, TENHOCVIEN, NGAYSINH, TINHTRANG, MALOP) VALUES ('HV00003', 'Nguyễn Xuân Phúc', TO_DATE('1994-12-30', 'YYYY-MM-DD'), 'Đang học', 'LH00002');
INSERT INTO HOCVIEN (MAHOCVIEN, TENHOCVIEN, NGAYSINH, TINHTRANG, MALOP) VALUES ('HV00004', 'Trần Minh An', TO_DATE('1991-12-03', 'YYYY-MM-DD'), 'Đang học', 'LH00003');
INSERT INTO HOCVIEN (MAHOCVIEN, TENHOCVIEN, NGAYSINH, TINHTRANG, MALOP) VALUES ('HV00005', 'Trần Minh Anh', TO_DATE('1992-03-12', 'YYYY-MM-DD'), 'Đang học', 'LH00003');
INSERT INTO HOCVIEN (MAHOCVIEN, TENHOCVIEN, NGAYSINH, TINHTRANG, MALOP) VALUES ('HV00006', 'Trương Mỹ Linh', TO_DATE('1989-12-12', 'YYYY-MM-DD'), 'Đã tốt nghiệp', 'LH00004');
INSERT INTO HOCVIEN (MAHOCVIEN, TENHOCVIEN, NGAYSINH, TINHTRANG, MALOP) VALUES ('HV00007', 'Trần Hào', TO_DATE('1989-02-02', 'YYYY-MM-DD'), 'Đã tốt nghiệp', 'LH00004');
INSERT INTO HOCVIEN (MAHOCVIEN, TENHOCVIEN, NGAYSINH, TINHTRANG, MALOP) VALUES ('HV00008', 'Nguyễn Huỳnh Hoa', TO_DATE('1992-02-03', 'YYYY-MM-DD'), 'Đang học', 'LH00004');
INSERT INTO HOCVIEN (MAHOCVIEN, TENHOCVIEN, NGAYSINH, TINHTRANG, MALOP) VALUES ('HV00009', 'Lê Xuân Ngọc', TO_DATE('1993-03-13', 'YYYY-MM-DD'), 'Đang học', 'LH00005');
INSERT INTO HOCVIEN (MAHOCVIEN, TENHOCVIEN, NGAYSINH, TINHTRANG, MALOP) VALUES ('HV00010', 'Nguyễn Bình Minh', TO_DATE('1992-03-12', 'YYYY-MM-DD'), 'Đang học', 'LH00004');
ALTER TABLE LOPHOC
ADD CONSTRAINT FK_LH_LOPTRUONG FOREIGN KEY (LOPTRUONG) REFERENCES HOCVIEN (MAHOCVIEN);



INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0001', 'MH00001', 3, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0001', 'MH00004', 2, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0002', 'MH00001', 1, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0002', 'MH00002', 1, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0003', 'MH00006', 2, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0003', 'MH00007', 3, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0003', 'MH00010', 4, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0004', 'MH00009', 6, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0004', 'MH00010', 1, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0005', 'MH00008', 4, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0005', 'MH00010', 2, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0006', 'MH00008', 4, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0006', 'MH00009', 2, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0006', 'MH00010', 4, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0007', 'MH00010', 7, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0008', 'MH00001', 2, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0008', 'MH00002', 1, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0009', 'MH00010', 2, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0010', 'MH00001', 3, NULL);
INSERT INTO GIAOVIEN_DAY_MONHOC (MAGV, MAMH, THAMNIEN, SOLOPDADAY) VALUES ('GV0010', 'MH00002', 1, NULL);

INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00001', 'MH00001', 1, 5.5);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00001', 'MH00004', 1, 6);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00002', 'MH00001', 1, 7);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00002', 'MH00004', 1, 8);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00003', 'MH00008', 1, 8.7);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00003', 'MH00009', 1, 9);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00003', 'MH00010', 1, 10);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00004', 'MH00008', 1, 4);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00004', 'MH00008', 2, 3);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00004', 'MH00009', 1, 2);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00004', 'MH00009', 2, 5);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00004', 'MH00010', 1, 6);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00005', 'MH00008', 1, 7.5);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00005', 'MH00009', 1, 1);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00005', 'MH00009', 2, 7);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00005', 'MH00010', 1, 1);
INSERT INTO KETQUA (MAHV, MAMONHOC, LANTHI, DIEM) VALUES ('HV00005', 'MH00010', 2, 3.5);

INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0001', 'MH00001', 'LH00001');
INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0001', 'MH00004', 'LH00001');
INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0003', 'MH00010', 'LH00005');
INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0004', 'MH00009', 'LH00004');
INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0005', 'MH00008', 'LH00002');
INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0005', 'MH00008', 'LH00004');
INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0006', 'MH00008', 'LH00003');
INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0006', 'MH00010', 'LH00004');
INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0007', 'MH00010', 'LH00002');
INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0007', 'MH00010', 'LH00003');
INSERT INTO PHANCONG (MAGV, MAMH, MALOP) VALUES ('GV0008', 'MH00002', 'LH00004');


--1
SELECT TENGV, TRUNC(MONTHS_BETWEEN(SYSDATE, NGAYSINH) / 12) AS TUOI
FROM GIAOVIEN
WHERE GIOITINH = 'Nữ';
--2
SELECT TENHOCVIEN, TINHTRANG
FROM HOCVIEN
WHERE MAHOCVIEN = 'HV000001';
--3
SELECT TENHOCVIEN
FROM HOCVIEN
WHERE TRUNC(MONTHS_BETWEEN(SYSDATE, NGAYSINH) / 12) <= 20;
--4
SELECT MALOP
FROM LOPHOC
WHERE (SELECT COUNT(*) FROM HOCVIEN WHERE HOCVIEN.MALOP = LOPHOC.MALOP) BETWEEN 2 AND 4;
--5
SELECT MAGV, TENGV, NGAYSINH
FROM GIAOVIEN
WHERE TENGV LIKE 'Nguyễn%';
--6
SELECT DISTINCT MAHV
FROM KETQUA
WHERE MAMONHOC IN ('MH00009', 'MH00010') AND DIEM < 5; 
--7
SELECT TENGV
FROM GIAOVIEN
WHERE MAGVQUANLI IS NULL;  
--8
SELECT DISTINCT MAGVQUANLI
FROM GIAOVIEN
WHERE MAGVQUANLI IN (SELECT DISTINCT MAGVQUANLI FROM GIAOVIEN WHERE MAGVQUANLI IS NOT NULL);
--9
SELECT DISTINCT MAGVQUANLI, TENGV
FROM GIAOVIEN
WHERE MAGVQUANLI IN (SELECT DISTINCT MAGVQUANLI FROM GIAOVIEN WHERE MAGVQUANLI IS NOT NULL);
--10
SELECT MAGVQUANLI
FROM GIAOVIEN
WHERE MAGVQUANLI IN ('GV00006', 'GV00007', 'GV00010');
--11
SELECT MAMONHOC
FROM MONHOC
WHERE TENMONHOC LIKE '%dữ liệu%';
--12
SELECT TENHOCVIEN
FROM HOCVIEN
WHERE TENHOCVIEN LIKE 'Trần%' AND (TINHTRANG = 'Tốt nghiệp' OR TINHTRANG = 'Bị buộc thôi học');
--13
SELECT MAHOCVIEN, TENHOCVIEN
FROM HOCVIEN
WHERE MAHOCVIEN IN (SELECT DISTINCT LOPTRUONG FROM LOPHOC WHERE LOPTRUONG IS NOT NULL);
--14
SELECT DISTINCT MAMONHOC, TENMONHOC
FROM KETQUA
JOIN MONHOC ON KETQUA.MAMONHOC = MONHOC.MAMONHOC
WHERE MAHOCVIEN = 'HV000005' AND KETQUA < 5; 
--15
SELECT MAHOCVIEN
FROM KETQUA
WHERE MAMONHOC = 'MH00009'
GROUP BY MAHOCVIEN
HAVING COUNT(*) > 1;
--16
SELECT MAHOCVIEN, TENHOCVIEN, MAX(KETQUA) AS DIEMCAONHAT
FROM KETQUA
JOIN HOCVIEN ON KETQUA.MAHOCVIEN = HOCVIEN.MAHOCVIEN
WHERE MAMONHOC = 'MH00009'
GROUP BY MAHOCVIEN, TENHOCVIEN;
--17
SELECT TENHOCVIEN, TRUNC(MONTHS_BETWEEN(SYSDATE, NGAYSINH) / 12) AS TUOI
FROM HOCVIEN
WHERE NGAYSINH = (SELECT MIN(NGAYSINH) FROM HOCVIEN);
--18
SELECT MAMONHOC, TENMONHOC, SOCHI
FROM MONHOC
WHERE MAMONHOC = (
    SELECT MAMONHOC
    FROM KETQUA
    WHERE KETQUA < 5  
    GROUP BY MAMONHOC
    ORDER BY COUNT(DISTINCT MAHOCVIEN) DESC
    FETCH FIRST 1 ROWS ONLY
);
--19
SELECT COUNT(DISTINCT MAMONHOC) AS SO_MON_DAU
FROM KETQUA
WHERE MAHOCVIEN = (
    SELECT MAHOCVIEN
    FROM HOCVIEN
    WHERE TENHOCVIEN = 'Trần Minh An'
) AND KETQUA >= 5;
--20
SELECT SUM(KETQUA * SOCHI) / SUM(SOCHI) AS DIEM_TRUNGBINH
FROM KETQUA
JOIN MONHOC ON KETQUA.MAMONHOC = MONHOC.MAMONHOC
WHERE MAHOCVIEN = 'HV000004'
GROUP BY MAHOCVIEN
HAVING MAHOCVIEN = 'HV000004' AND MAMONHOC IN (
    SELECT MAMONHOC
    FROM KETQUA
    WHERE MAHOCVIEN = 'HV000004'
    GROUP BY MAMONHOC
    HAVING ROWNUM = 1
);
--21
SELECT SUM(SOCHI) AS SO_TIN_CHI_DAT
FROM KETQUA
JOIN MONHOC ON KETQUA.MAMONHOC = MONHOC.MAMONHOC
WHERE MAHOCVIEN = (
    SELECT MAHOCVIEN
    FROM HOCVIEN
    WHERE TENHOCVIEN = 'Trần Minh An'
) AND KETQUA >= 5;
--22
SELECT TENHOCVIEN, SUM(SOCHI) AS SO_TIN_CHI_DAT
FROM HOCVIEN
JOIN KETQUA ON HOCVIEN.MAHOCVIEN = KETQUA.MAHOCVIEN
JOIN MONHOC ON KETQUA.MAMONHOC = MONHOC.MAMONHOC
WHERE KETQUA >= 5 
GROUP BY TENHOCVIEN
HAVING SUM(SOCHI) > 8;
--23
SELECT HOCVIEN.TENHOCVIEN, 
       SUM(KETQUA.KETQUA * MONHOC.SOCHI) / SUM(MONHOC.SOCHI) AS DIEM_TRUNGBINH
FROM HOCVIEN
JOIN KETQUA ON HOCVIEN.MAHOCVIEN = KETQUA.MAHOCVIEN
JOIN MONHOC ON KETQUA.MAMONHOC = MONHOC.MAMONHOC
GROUP BY HOCVIEN.TENHOCVIEN;
--24
SELECT HOCVIEN.*
FROM HOCVIEN
WHERE MAHOCVIEN NOT IN (
    SELECT MAHOCVIEN
    FROM KETQUA
    WHERE KETQUA < 5
    GROUP BY MAHOCVIEN, MAMONHOC
);
--25
SELECT LOPHOC.*
FROM LOPHOC
WHERE MALOP NOT IN (
    SELECT MALOP
    FROM HOCVIEN
    WHERE MAHOCVIEN IN (
        SELECT MAHOCVIEN
        FROM KETQUA
        WHERE KETQUA < 5
        GROUP BY MAHOCVIEN, MAMONHOC
    )
);